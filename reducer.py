#!/usr/bin/env python

"""reducer.py"""

"""
Author: Joe Yelland // B525320 // COC251
#----------------------------------------#
STAGE 2 - Reducer 
Input: The list of alarm log tuples outputted from the mapper
Output: A list of generalized alarm clusters, with each alarm in a cluster having the same root cause
#----------------------------------------#
START SOURCES
[1] - https://stackoverflow.com/questions/1883980/find-the-nth-occurrence-of-substring-in-a-string/
[2] - https://www.python.org/doc/essays/graphs/
END SOURCES
#----------------------------------------#
"""
from mapper_output import a1
import sys
import ast

#----------------------------------------# GETTING THE MAPPER OUTPUT
#for alarms in sys.stdin:
#	mapper_output = alarms
#----------------------------------------# GETTING THE MAPPER OUTPUT

#----------------------------------------# GRAPH FOR FUNCITON TESTING
graph = {
	'A':['B','C'],
	'B':['D','E'],
	'C':['F','G'],
	'D':['H','I'],
	'E':['J','K'],
	'F':['L','M'],
	'G':['N','O']
	}
#----------------------------------------# GRAPH FOR FUNCITON TESTING

#----------------------------------------# SETTING UP HIERARCHIES
priv_ports = list(range(1,1025))
priv_port_list = []

non_priv_ports = list(range(1025,65535))
non_priv_port_list = []

for i in non_priv_ports:
	y = str(i)
	non_priv_port_list.append(y)

for i in priv_ports:
	x = str(i)
	priv_port_list.append(x)


http_ftp_ip = [
	'Undefined',
	'10.10.0.7',
	'10.10.9.109',
	'10.11.11.21',
	'10.20.250.49',
	'10.21.6.40',
	'10.21.67.10',
	'10.50.253.160',
	'10.51.17.10',
	'10.61.9.10',
	'10.7.136.109',
	'10.7.136.159',
	'10.7.136.63',
	'10.7.137.108',
	'172.16.4.100',
	'172.16.6.100',
	'172.16.7.100',
	'172.16.8.100',
	'172.19.1.100',
	'192.138.21.103',
	'192.168.1.255',
	'192.168.10.100',
	'192.168.169.254',
	'192.168.200.68',
	'192.168.202.100',
	'192.168.202.102',
	'192.168.202.110',
	'192.168.202.68',
	'192.168.202.73',
	'192.168.202.78',
	'192.168.202.79',
	'192.168.202.81',
	'192.168.202.82',
	'192.168.202.92',
	'192.168.202.96',
	'192.168.203.45',
	'192.168.203.61',
	'192.168.203.62',
	'192.168.204.45',
	'192.168.204.70',
	'192.168.206.44',
	'192.168.208.44',
	'192.168.21.1',
	'192.168.21.100',
	'192.168.21.101',
	'192.168.21.102',
	'192.168.21.103',
	'192.168.21.108',
	'192.168.21.113',
	'192.168.21.118',
	'192.168.21.123',
	'192.168.21.128',
	'192.168.21.13',
	'192.168.21.133',
	'192.168.21.138',
	'192.168.21.143',
	'192.168.21.148',
	'192.168.21.152',
	'192.168.21.154',
	'192.168.21.159',
	'192.168.21.164',
	'192.168.21.169',
	'192.168.21.174',
	'192.168.21.179',
	'192.168.21.18',
	'192.168.21.184',
	'192.168.21.189',
	'192.168.21.19',
	'192.168.21.194',
	'192.168.21.199',
	'192.168.21.202',
	'192.168.21.203',
	'192.168.21.206',
	'192.168.21.211',
	'192.168.21.216',
	'192.168.21.221',
	'192.168.21.226',
	'192.168.21.23',
	'192.168.21.231',
	'192.168.21.236',
	'192.168.21.241',
	'192.168.21.246',
	'192.168.21.25',
	'192.168.21.251',
	'192.168.21.252',
	'192.168.21.253',
	'192.168.21.254',
	'192.168.21.29',
	'192.168.21.3',
	'192.168.21.30',
	'192.168.21.31',
	'192.168.21.34',
	'192.168.21.39',
	'192.168.21.44',
	'192.168.21.48',
	'192.168.21.49',
	'192.168.21.54',
	'192.168.21.59',
	'192.168.21.6',
	'192.168.21.64',
	'192.168.21.69',
	'192.168.21.71',
	'192.168.21.72',
	'192.168.21.74',
	'192.168.21.79',
	'192.168.21.8',
	'192.168.21.84',
	'192.168.21.89',
	'192.168.21.94',
	'192.168.21.99',
	'192.168.22.1',
	'192.168.22.100',
	'192.168.22.101',
	'192.168.22.102',
	'192.168.22.103',
	'192.168.22.110',
	'192.168.22.115',
	'192.168.22.119',
	'192.168.22.124',
	'192.168.22.129',
	'192.168.22.138',
	'192.168.22.14',
	'192.168.22.143',
	'192.168.22.148',
	'192.168.22.152',
	'192.168.22.158',
	'192.168.22.163',
	'192.168.22.168',
	'192.168.22.173',
	'192.168.22.178',
	'192.168.22.183',
	'192.168.22.188',
	'192.168.22.19',
	'192.168.22.193',
	'192.168.22.198',
	'192.168.22.202',
	'192.168.22.203',
	'192.168.22.205',
	'192.168.22.210',
	'192.168.22.215',
	'192.168.22.220',
	'192.168.22.225',
	'192.168.22.230',
	'192.168.22.235',
	'192.168.22.24',
	'192.168.22.240',
	'192.168.22.245',
	'192.168.22.249',
	'192.168.22.25',
	'192.168.22.250',
	'192.168.22.252',
	'192.168.22.253',
	'192.168.22.254',
	'192.168.22.30',
	'192.168.22.35',
	'192.168.22.4',
	'192.168.22.40',
	'192.168.22.45',
	'192.168.22.50',
	'192.168.22.54',
	'192.168.22.59',
	'192.168.22.64',
	'192.168.22.69',
	'192.168.22.73',
	'192.168.22.78',
	'192.168.22.83',
	'192.168.22.88',
	'192.168.22.9',
	'192.168.22.92',
	'192.168.22.97',
	'192.168.229.1',
	'192.168.229.101',
	'192.168.229.153',
	'192.168.229.156',
	'192.168.229.251',
	'192.168.229.252',
	'192.168.229.254',
	'192.168.23.1',
	'192.168.23.100',
	'192.168.23.101',
	'192.168.23.102',
	'192.168.23.103',
	'192.168.23.108',
	'192.168.23.113',
	'192.168.23.118',
	'192.168.23.123',
	'192.168.23.128',
	'192.168.23.13',
	'192.168.23.133',
	'192.168.23.138',
	'192.168.23.143',
	'192.168.23.148',
	'192.168.23.152',
	'192.168.23.154',
	'192.168.23.159',
	'192.168.23.164',
	'192.168.23.169',
	'192.168.23.174',
	'192.168.23.179',
	'192.168.23.18',
	'192.168.23.184',
	'192.168.23.189',
	'192.168.23.194',
	'192.168.23.199',
	'192.168.23.202',
	'192.168.23.203',
	'192.168.23.206',
	'192.168.23.211',
	'192.168.23.216',
	'192.168.23.221',
	'192.168.23.226',
	'192.168.23.23',
	'192.168.23.231',
	'192.168.23.236',
	'192.168.23.241',
	'192.168.23.246',
	'192.168.23.25',
	'192.168.23.251',
	'192.168.23.253',
	'192.168.23.254',
	'192.168.23.29',
	'192.168.23.3',
	'192.168.23.34',
	'192.168.23.38',
	'192.168.23.39',
	'192.168.23.44',
	'192.168.23.49',
	'192.168.23.54',
	'192.168.23.59',
	'192.168.23.64',
	'192.168.23.69',
	'192.168.23.74',
	'192.168.23.79',
	'192.168.23.8',
	'192.168.23.84',
	'192.168.23.89',
	'192.168.23.94',
	'192.168.23.99',
	'192.168.24.1',
	'192.168.24.100',
	'192.168.24.101',
	'192.168.24.102',
	'192.168.24.103',
	'192.168.24.108',
	'192.168.24.113',
	'192.168.24.118',
	'192.168.24.123',
	'192.168.24.128',
	'192.168.24.13',
	'192.168.24.133',
	'192.168.24.138',
	'192.168.24.143',
	'192.168.24.148',
	'192.168.24.152',
	'192.168.24.154',
	'192.168.24.159',
	'192.168.24.164',
	'192.168.24.169',
	'192.168.24.174',
	'192.168.24.179',
	'192.168.24.18',
	'192.168.24.184',
	'192.168.24.189',
	'192.168.24.194',
	'192.168.24.199',
	'192.168.24.202',
	'192.168.24.203',
	'192.168.24.206',
	'192.168.24.211',
	'192.168.24.216',
	'192.168.24.221',
	'192.168.24.226',
	'192.168.24.23',
	'192.168.24.231',
	'192.168.24.236',
	'192.168.24.241',
	'192.168.24.246',
	'192.168.24.25',
	'192.168.24.251',
	'192.168.24.252',
	'192.168.24.253',
	'192.168.24.254',
	'192.168.24.29',
	'192.168.24.3',
	'192.168.24.34',
	'192.168.24.39',
	'192.168.24.44',
	'192.168.24.49',
	'192.168.24.54',
	'192.168.24.59',
	'192.168.24.64',
	'192.168.24.69',
	'192.168.24.74',
	'192.168.24.79',
	'192.168.24.8',
	'192.168.24.84',
	'192.168.24.89',
	'192.168.24.94',
	'192.168.24.99',
	'192.168.25.1',
	'192.168.25.100',
	'192.168.25.101',
	'192.168.25.102',
	'192.168.25.103',
	'192.168.25.104',
	'192.168.25.109',
	'192.168.25.114',
	'192.168.25.119',
	'192.168.25.124',
	'192.168.25.129',
	'192.168.25.134',
	'192.168.25.139',
	'192.168.25.14',
	'192.168.25.144',
	'192.168.25.149',
	'192.168.25.152',
	'192.168.25.155',
	'192.168.25.160',
	'192.168.25.165',
	'192.168.25.170',
	'192.168.25.175',
	'192.168.25.180',
	'192.168.25.185',
	'192.168.25.19',
	'192.168.25.190',
	'192.168.25.195',
	'192.168.25.200',
	'192.168.25.202',
	'192.168.25.203',
	'192.168.25.207',
	'192.168.25.212',
	'192.168.25.217',
	'192.168.25.222',
	'192.168.25.227',
	'192.168.25.232',
	'192.168.25.237',
	'192.168.25.24',
	'192.168.25.242',
	'192.168.25.247',
	'192.168.25.25',
	'192.168.25.252',
	'192.168.25.253',
	'192.168.25.254',
	'192.168.25.30',
	'192.168.25.31',
	'192.168.25.35',
	'192.168.25.4',
	'192.168.25.40',
	'192.168.25.45',
	'192.168.25.50',
	'192.168.25.55',
	'192.168.25.60',
	'192.168.25.65',
	'192.168.25.70',
	'192.168.25.75',
	'192.168.25.80',
	'192.168.25.85',
	'192.168.25.9',
	'192.168.25.90',
	'192.168.25.95',
	'192.168.26.1',
	'192.168.26.100',
	'192.168.26.101',
	'192.168.26.102',
	'192.168.26.103',
	'192.168.26.104',
	'192.168.26.109',
	'192.168.26.114',
	'192.168.26.119',
	'192.168.26.124',
	'192.168.26.129',
	'192.168.26.134',
	'192.168.26.139',
	'192.168.26.14',
	'192.168.26.144',
	'192.168.26.149',
	'192.168.26.152',
	'192.168.26.155',
	'192.168.26.160',
	'192.168.26.165',
	'192.168.26.170',
	'192.168.26.175',
	'192.168.26.180',
	'192.168.26.185',
	'192.168.26.19',
	'192.168.26.190',
	'192.168.26.195',
	'192.168.26.200',
	'192.168.26.202',
	'192.168.26.203',
	'192.168.26.207',
	'192.168.26.212',
	'192.168.26.217',
	'192.168.26.222',
	'192.168.26.227',
	'192.168.26.232',
	'192.168.26.237',
	'192.168.26.24',
	'192.168.26.242',
	'192.168.26.247',
	'192.168.26.25',
	'192.168.26.252',
	'192.168.26.253',
	'192.168.26.254',
	'192.168.26.255',
	'192.168.26.30',
	'192.168.26.35',
	'192.168.26.4',
	'192.168.26.40',
	'192.168.26.45',
	'192.168.26.50',
	'192.168.26.55',
	'192.168.26.60',
	'192.168.26.65',
	'192.168.26.70',
	'192.168.26.75',
	'192.168.26.80',
	'192.168.26.85',
	'192.168.26.9',
	'192.168.26.90',
	'192.168.26.95',
	'192.168.27.1',
	'192.168.27.10',
	'192.168.27.100',
	'192.168.27.101',
	'192.168.27.102',
	'192.168.27.103',
	'192.168.27.104',
	'192.168.27.105',
	'192.168.27.106',
	'192.168.27.107',
	'192.168.27.108',
	'192.168.27.109',
	'192.168.27.11',
	'192.168.27.110',
	'192.168.27.111',
	'192.168.27.112',
	'192.168.27.113',
	'192.168.27.114',
	'192.168.27.115',
	'192.168.27.116',
	'192.168.27.117',
	'192.168.27.118',
	'192.168.27.119',
	'192.168.27.12',
	'192.168.27.120',
	'192.168.27.121',
	'192.168.27.122',
	'192.168.27.123',
	'192.168.27.124',
	'192.168.27.125',
	'192.168.27.126',
	'192.168.27.127',
	'192.168.27.128',
	'192.168.27.129',
	'192.168.27.13',
	'192.168.27.130',
	'192.168.27.131',
	'192.168.27.132',
	'192.168.27.133',
	'192.168.27.134',
	'192.168.27.135',
	'192.168.27.136',
	'192.168.27.137',
	'192.168.27.138',
	'192.168.27.139',
	'192.168.27.14',
	'192.168.27.140',
	'192.168.27.141',
	'192.168.27.142',
	'192.168.27.143',
	'192.168.27.144',
	'192.168.27.145',
	'192.168.27.146',
	'192.168.27.147',
	'192.168.27.148',
	'192.168.27.149',
	'192.168.27.15',
	'192.168.27.150',
	'192.168.27.151',
	'192.168.27.152',
	'192.168.27.153',
	'192.168.27.154',
	'192.168.27.155',
	'192.168.27.156',
	'192.168.27.157',
	'192.168.27.158',
	'192.168.27.159',
	'192.168.27.16',
	'192.168.27.160',
	'192.168.27.161',
	'192.168.27.162',
	'192.168.27.163',
	'192.168.27.164',
	'192.168.27.165',
	'192.168.27.166',
	'192.168.27.167',
	'192.168.27.168',
	'192.168.27.169',
	'192.168.27.17',
	'192.168.27.170',
	'192.168.27.171',
	'192.168.27.172',
	'192.168.27.173',
	'192.168.27.174',
	'192.168.27.175',
	'192.168.27.176',
	'192.168.27.177',
	'192.168.27.178',
	'192.168.27.179',
	'192.168.27.18',
	'192.168.27.180',
	'192.168.27.181',
	'192.168.27.182',
	'192.168.27.183',
	'192.168.27.184',
	'192.168.27.185',
	'192.168.27.186',
	'192.168.27.187',
	'192.168.27.188',
	'192.168.27.189',
	'192.168.27.19',
	'192.168.27.190',
	'192.168.27.191',
	'192.168.27.192',
	'192.168.27.193',
	'192.168.27.194',
	'192.168.27.195',
	'192.168.27.196',
	'192.168.27.197',
	'192.168.27.198',
	'192.168.27.199',
	'192.168.27.2',
	'192.168.27.20',
	'192.168.27.200',
	'192.168.27.201',
	'192.168.27.202',
	'192.168.27.203',
	'192.168.27.204',
	'192.168.27.205',
	'192.168.27.206',
	'192.168.27.207',
	'192.168.27.208',
	'192.168.27.209',
	'192.168.27.21',
	'192.168.27.210',
	'192.168.27.211',
	'192.168.27.212',
	'192.168.27.213',
	'192.168.27.214',
	'192.168.27.215',
	'192.168.27.216',
	'192.168.27.217',
	'192.168.27.218',
	'192.168.27.219',
	'192.168.27.22',
	'192.168.27.220',
	'192.168.27.221',
	'192.168.27.222',
	'192.168.27.223',
	'192.168.27.224',
	'192.168.27.225',
	'192.168.27.226',
	'192.168.27.227',
	'192.168.27.228',
	'192.168.27.229',
	'192.168.27.23',
	'192.168.27.230',
	'192.168.27.231',
	'192.168.27.232',
	'192.168.27.233',
	'192.168.27.234',
	'192.168.27.235',
	'192.168.27.236',
	'192.168.27.237',
	'192.168.27.238',
	'192.168.27.239',
	'192.168.27.24',
	'192.168.27.240',
	'192.168.27.241',
	'192.168.27.242',
	'192.168.27.243',
	'192.168.27.244',
	'192.168.27.245',
	'192.168.27.246',
	'192.168.27.247',
	'192.168.27.248',
	'192.168.27.249',
	'192.168.27.25',
	'192.168.27.250',
	'192.168.27.251',
	'192.168.27.252',
	'192.168.27.253',
	'192.168.27.254',
	'192.168.27.26',
	'192.168.27.27',
	'192.168.27.28',
	'192.168.27.29',
	'192.168.27.3',
	'192.168.27.30',
	'192.168.27.31',
	'192.168.27.32',
	'192.168.27.33',
	'192.168.27.34',
	'192.168.27.35',
	'192.168.27.36',
	'192.168.27.37',
	'192.168.27.38',
	'192.168.27.39',
	'192.168.27.4',
	'192.168.27.40',
	'192.168.27.41',
	'192.168.27.42',
	'192.168.27.43',
	'192.168.27.44',
	'192.168.27.45',
	'192.168.27.46',
	'192.168.27.47',
	'192.168.27.48',
	'192.168.27.49',
	'192.168.27.5',
	'192.168.27.50',
	'192.168.27.51',
	'192.168.27.52',
	'192.168.27.53',
	'192.168.27.54',
	'192.168.27.55',
	'192.168.27.56',
	'192.168.27.57',
	'192.168.27.58',
	'192.168.27.59',
	'192.168.27.6',
	'192.168.27.60',
	'192.168.27.61',
	'192.168.27.62',
	'192.168.27.63',
	'192.168.27.64',
	'192.168.27.65',
	'192.168.27.66',
	'192.168.27.67',
	'192.168.27.68',
	'192.168.27.69',
	'192.168.27.7',
	'192.168.27.70',
	'192.168.27.71',
	'192.168.27.72',
	'192.168.27.73',
	'192.168.27.74',
	'192.168.27.75',
	'192.168.27.76',
	'192.168.27.77',
	'192.168.27.78',
	'192.168.27.79',
	'192.168.27.8',
	'192.168.27.80',
	'192.168.27.81',
	'192.168.27.82',
	'192.168.27.83',
	'192.168.27.84',
	'192.168.27.85',
	'192.168.27.86',
	'192.168.27.87',
	'192.168.27.88',
	'192.168.27.89',
	'192.168.27.9',
	'192.168.27.90',
	'192.168.27.91',
	'192.168.27.92',
	'192.168.27.93',
	'192.168.27.94',
	'192.168.27.95',
	'192.168.27.96',
	'192.168.27.97',
	'192.168.27.98',
	'192.168.27.99',
	'192.168.28.0',
	'192.168.28.1',
	'192.168.28.100',
	'192.168.28.101',
	'192.168.28.102',
	'192.168.28.103',
	'192.168.28.106',
	'192.168.28.11',
	'192.168.28.111',
	'192.168.28.116',
	'192.168.28.121',
	'192.168.28.126',
	'192.168.28.131',
	'192.168.28.136',
	'192.168.28.141',
	'192.168.28.146',
	'192.168.28.151',
	'192.168.28.152',
	'192.168.28.157',
	'192.168.28.16',
	'192.168.28.162',
	'192.168.28.167',
	'192.168.28.172',
	'192.168.28.177',
	'192.168.28.182',
	'192.168.28.187',
	'192.168.28.192',
	'192.168.28.197',
	'192.168.28.202',
	'192.168.28.203',
	'192.168.28.204',
	'192.168.28.209',
	'192.168.28.21',
	'192.168.28.214',
	'192.168.28.219',
	'192.168.28.224',
	'192.168.28.229',
	'192.168.28.234',
	'192.168.28.239',
	'192.168.28.244',
	'192.168.28.249',
	'192.168.28.25',
	'192.168.28.252',
	'192.168.28.253',
	'192.168.28.254',
	'192.168.28.27',
	'192.168.28.32',
	'192.168.28.37',
	'192.168.28.42',
	'192.168.28.47',
	'192.168.28.52',
	'192.168.28.57',
	'192.168.28.6',
	'192.168.28.62',
	'192.168.28.67',
	'192.168.28.72',
	'192.168.28.77',
	'192.168.28.82',
	'192.168.28.87',
	'192.168.28.92',
	'192.168.28.97']

internet_ip = [
	'Undefined',
	'0.0.0.0',
	'10.10.0.7',
	'10.10.9.109',
	'10.11.11.21',
	'10.20.250.49',
	'10.21.6.40',
	'10.21.67.10',
	'10.50.253.160',
	'10.51.17.10',
	'10.61.9.10',
	'10.7.136.109',
	'10.7.136.159',
	'10.7.136.63',
	'10.7.137.108',
	'109.201.131.11',
	'110.209.6.25',
	'111.221.74.12',
	'111.221.74.13',
	'111.221.74.14',
	'111.221.74.16',
	'111.221.74.17',
	'111.221.74.18',
	'111.221.74.19',
	'111.221.74.23',
	'111.221.74.25',
	'111.221.74.26',
	'111.221.74.28',
	'111.221.74.31',
	'111.221.74.34',
	'111.221.74.37',
	'111.221.74.38',
	'111.221.77.140',
	'111.221.77.141',
	'111.221.77.143',
	'111.221.77.145',
	'111.221.77.146',
	'111.221.77.147',
	'111.221.77.148',
	'111.221.77.149',
	'111.221.77.153',
	'111.221.77.155',
	'111.221.77.159',
	'111.221.77.160',
	'111.221.77.162',
	'111.221.77.165',
	'127.0.0.1',
	'137.56.163.64',
	'141.219.155.230',
	'149.5.45.140',
	'149.5.45.166',
	'149.9.0.58',
	'154.35.32.5',
	'156.154.70.22',
	'157.55.130.146',
	'157.55.130.151',
	'157.55.130.152',
	'157.55.130.153',
	'157.55.130.156',
	'157.55.130.157',
	'157.55.130.158',
	'157.55.130.159',
	'157.55.130.160',
	'157.55.130.161',
	'157.55.130.162',
	'157.55.130.165',
	'157.55.235.140',
	'157.55.235.142',
	'157.55.235.144',
	'157.55.235.145',
	'157.55.235.146',
	'157.55.235.147',
	'157.55.235.151',
	'157.55.235.152',
	'157.55.235.153',
	'157.55.235.154',
	'157.55.235.156',
	'157.55.235.158',
	'157.55.235.160',
	'157.55.235.162',
	'157.55.235.165',
	'157.55.56.140',
	'157.55.56.141',
	'157.55.56.143',
	'157.55.56.144',
	'157.55.56.145',
	'157.55.56.147',
	'157.55.56.148',
	'157.55.56.150',
	'157.55.56.152',
	'157.55.56.155',
	'157.55.56.157',
	'157.55.56.159',
	'157.55.56.160',
	'157.55.56.162',
	'157.55.56.165',
	'157.56.52.12',
	'157.56.52.14',
	'157.56.52.15',
	'157.56.52.16',
	'157.56.52.17',
	'157.56.52.18',
	'157.56.52.19',
	'157.56.52.24',
	'157.56.52.25',
	'157.56.52.28',
	'157.56.52.30',
	'157.56.52.33',
	'157.56.52.37',
	'157.56.52.38',
	'159.99.66.200',
	'17.151.16.22',
	'17.151.16.30',
	'17.171.4.24',
	'171.25.193.21',
	'172.16.4.100',
	'172.16.6.100',
	'172.16.7.100',
	'172.16.8.100',
	'172.19.1.100',
	'173.194.43.0',
	'173.194.43.1',
	'173.194.43.10',
	'173.194.43.14',
	'173.194.43.17',
	'173.194.43.2',
	'173.194.43.20',
	'173.194.43.26',
	'173.194.43.3',
	'173.194.43.4',
	'173.194.43.5',
	'173.194.43.6',
	'173.194.43.7',
	'173.194.43.8',
	'173.194.43.9',
	'173.245.60.114',
	'174.129.217.197',
	'174.129.243.85',
	'176.31.122.29',
	'176.9.106.116',
	'178.238.224.71',
	'178.255.83.1',
	'178.255.83.2',
	'178.63.16.48',
	'178.63.97.34',
	'183.182.82.14',
	'184.49.188.129',
	'187.11.237.198',
	'188.40.209.99',
	'188.40.59.123',
	'188.40.98.54',
	'192.138.21.103',
	'192.168.1.254',
	'192.168.1.255',
	'192.168.10.100',
	'192.168.169.254',
	'192.168.200.68',
	'192.168.202.10',
	'192.168.202.100',
	'192.168.202.101',
	'192.168.202.102',
	'192.168.202.103',
	'192.168.202.106',
	'192.168.202.107',
	'192.168.202.109',
	'192.168.202.110',
	'192.168.202.112',
	'192.168.202.113',
	'192.168.202.115',
	'192.168.202.65',
	'192.168.202.68',
	'192.168.202.69',
	'192.168.202.73',
	'192.168.202.76',
	'192.168.202.77',
	'192.168.202.78',
	'192.168.202.79',
	'192.168.202.80',
	'192.168.202.81',
	'192.168.202.82',
	'192.168.202.83',
	'192.168.202.84',
	'192.168.202.86',
	'192.168.202.87',
	'192.168.202.88',
	'192.168.202.89',
	'192.168.202.92',
	'192.168.202.93',
	'192.168.202.94',
	'192.168.202.96',
	'192.168.202.97',
	'192.168.203.45',
	'192.168.203.61',
	'192.168.203.62',
	'192.168.203.63',
	'192.168.204.45',
	'192.168.204.57',
	'192.168.204.69',
	'192.168.204.70',
	'192.168.206.44',
	'192.168.207.4',
	'192.168.208.44',
	'192.168.21.1',
	'192.168.21.100',
	'192.168.21.101',
	'192.168.21.102',
	'192.168.21.103',
	'192.168.21.108',
	'192.168.21.113',
	'192.168.21.118',
	'192.168.21.123',
	'192.168.21.128',
	'192.168.21.13',
	'192.168.21.133',
	'192.168.21.138',
	'192.168.21.143',
	'192.168.21.148',
	'192.168.21.152',
	'192.168.21.154',
	'192.168.21.159',
	'192.168.21.164',
	'192.168.21.169',
	'192.168.21.174',
	'192.168.21.179',
	'192.168.21.18',
	'192.168.21.184',
	'192.168.21.189',
	'192.168.21.19',
	'192.168.21.194',
	'192.168.21.199',
	'192.168.21.202',
	'192.168.21.203',
	'192.168.21.206',
	'192.168.21.211',
	'192.168.21.216',
	'192.168.21.221',
	'192.168.21.226',
	'192.168.21.23',
	'192.168.21.231',
	'192.168.21.236',
	'192.168.21.241',
	'192.168.21.246',
	'192.168.21.25',
	'192.168.21.251',
	'192.168.21.252',
	'192.168.21.253',
	'192.168.21.254',
	'192.168.21.29',
	'192.168.21.3',
	'192.168.21.30',
	'192.168.21.31',
	'192.168.21.34',
	'192.168.21.39',
	'192.168.21.44',
	'192.168.21.48',
	'192.168.21.49',
	'192.168.21.54',
	'192.168.21.59',
	'192.168.21.6',
	'192.168.21.64',
	'192.168.21.69',
	'192.168.21.71',
	'192.168.21.72',
	'192.168.21.74',
	'192.168.21.79',
	'192.168.21.8',
	'192.168.21.84',
	'192.168.21.89',
	'192.168.21.94',
	'192.168.21.99',
	'192.168.22.1',
	'192.168.22.100',
	'192.168.22.101',
	'192.168.22.102',
	'192.168.22.103',
	'192.168.22.110',
	'192.168.22.115',
	'192.168.22.119',
	'192.168.22.124',
	'192.168.22.129',
	'192.168.22.138',
	'192.168.22.14',
	'192.168.22.143',
	'192.168.22.148',
	'192.168.22.152',
	'192.168.22.158',
	'192.168.22.163',
	'192.168.22.168',
	'192.168.22.173',
	'192.168.22.178',
	'192.168.22.183',
	'192.168.22.188',
	'192.168.22.19',
	'192.168.22.193',
	'192.168.22.198',
	'192.168.22.202',
	'192.168.22.203',
	'192.168.22.205',
	'192.168.22.210',
	'192.168.22.215',
	'192.168.22.220',
	'192.168.22.225',
	'192.168.22.230',
	'192.168.22.235',
	'192.168.22.24',
	'192.168.22.240',
	'192.168.22.245',
	'192.168.22.249',
	'192.168.22.25',
	'192.168.22.250',
	'192.168.22.252',
	'192.168.22.253',
	'192.168.22.254',
	'192.168.22.30',
	'192.168.22.35',
	'192.168.22.4',
	'192.168.22.40',
	'192.168.22.45',
	'192.168.22.50',
	'192.168.22.54',
	'192.168.22.59',
	'192.168.22.64',
	'192.168.22.69',
	'192.168.22.73',
	'192.168.22.78',
	'192.168.22.83',
	'192.168.22.88',
	'192.168.22.9',
	'192.168.22.92',
	'192.168.22.97',
	'192.168.229.1',
	'192.168.229.101',
	'192.168.229.153',
	'192.168.229.156',
	'192.168.229.251',
	'192.168.229.252',
	'192.168.229.254',
	'192.168.23.1',
	'192.168.23.100',
	'192.168.23.101',
	'192.168.23.102',
	'192.168.23.103',
	'192.168.23.108',
	'192.168.23.113',
	'192.168.23.118',
	'192.168.23.123',
	'192.168.23.128',
	'192.168.23.13',
	'192.168.23.133',
	'192.168.23.138',
	'192.168.23.143',
	'192.168.23.148',
	'192.168.23.152',
	'192.168.23.154',
	'192.168.23.159',
	'192.168.23.164',
	'192.168.23.169',
	'192.168.23.174',
	'192.168.23.179',
	'192.168.23.18',
	'192.168.23.184',
	'192.168.23.189',
	'192.168.23.194',
	'192.168.23.199',
	'192.168.23.202',
	'192.168.23.203',
	'192.168.23.206',
	'192.168.23.211',
	'192.168.23.216',
	'192.168.23.221',
	'192.168.23.226',
	'192.168.23.23',
	'192.168.23.231',
	'192.168.23.236',
	'192.168.23.241',
	'192.168.23.246',
	'192.168.23.25',
	'192.168.23.251',
	'192.168.23.253',
	'192.168.23.254',
	'192.168.23.29',
	'192.168.23.3',
	'192.168.23.34',
	'192.168.23.38',
	'192.168.23.39',
	'192.168.23.44',
	'192.168.23.49',
	'192.168.23.54',
	'192.168.23.59',
	'192.168.23.64',
	'192.168.23.69',
	'192.168.23.74',
	'192.168.23.79',
	'192.168.23.8',
	'192.168.23.84',
	'192.168.23.89',
	'192.168.23.94',
	'192.168.23.99',
	'192.168.24.1',
	'192.168.24.100',
	'192.168.24.101',
	'192.168.24.102',
	'192.168.24.103',
	'192.168.24.108',
	'192.168.24.113',
	'192.168.24.118',
	'192.168.24.123',
	'192.168.24.128',
	'192.168.24.13',
	'192.168.24.133',
	'192.168.24.138',
	'192.168.24.143',
	'192.168.24.148',
	'192.168.24.152',
	'192.168.24.154',
	'192.168.24.159',
	'192.168.24.164',
	'192.168.24.169',
	'192.168.24.174',
	'192.168.24.179',
	'192.168.24.18',
	'192.168.24.184',
	'192.168.24.189',
	'192.168.24.194',
	'192.168.24.199',
	'192.168.24.202',
	'192.168.24.203',
	'192.168.24.206',
	'192.168.24.211',
	'192.168.24.216',
	'192.168.24.221',
	'192.168.24.226',
	'192.168.24.23',
	'192.168.24.231',
	'192.168.24.236',
	'192.168.24.241',
	'192.168.24.246',
	'192.168.24.25',
	'192.168.24.251',
	'192.168.24.252',
	'192.168.24.253',
	'192.168.24.254',
	'192.168.24.29',
	'192.168.24.3',
	'192.168.24.34',
	'192.168.24.39',
	'192.168.24.44',
	'192.168.24.49',
	'192.168.24.54',
	'192.168.24.59',
	'192.168.24.64',
	'192.168.24.69',
	'192.168.24.74',
	'192.168.24.79',
	'192.168.24.8',
	'192.168.24.84',
	'192.168.24.89',
	'192.168.24.94',
	'192.168.24.99',
	'192.168.25.1',
	'192.168.25.100',
	'192.168.25.101',
	'192.168.25.102',
	'192.168.25.103',
	'192.168.25.104',
	'192.168.25.109',
	'192.168.25.114',
	'192.168.25.119',
	'192.168.25.124',
	'192.168.25.129',
	'192.168.25.134',
	'192.168.25.139',
	'192.168.25.14',
	'192.168.25.144',
	'192.168.25.149',
	'192.168.25.152',
	'192.168.25.155',
	'192.168.25.160',
	'192.168.25.165',
	'192.168.25.170',
	'192.168.25.175',
	'192.168.25.180',
	'192.168.25.185',
	'192.168.25.19',
	'192.168.25.190',
	'192.168.25.195',
	'192.168.25.200',
	'192.168.25.202',
	'192.168.25.203',
	'192.168.25.207',
	'192.168.25.212',
	'192.168.25.217',
	'192.168.25.222',
	'192.168.25.227',
	'192.168.25.232',
	'192.168.25.237',
	'192.168.25.24',
	'192.168.25.242',
	'192.168.25.247',
	'192.168.25.25',
	'192.168.25.252',
	'192.168.25.253',
	'192.168.25.254',
	'192.168.25.30',
	'192.168.25.31',
	'192.168.25.35',
	'192.168.25.4',
	'192.168.25.40',
	'192.168.25.45',
	'192.168.25.50',
	'192.168.25.55',
	'192.168.25.60',
	'192.168.25.65',
	'192.168.25.70',
	'192.168.25.75',
	'192.168.25.80',
	'192.168.25.85',
	'192.168.25.9',
	'192.168.25.90',
	'192.168.25.95',
	'192.168.26.1',
	'192.168.26.100',
	'192.168.26.101',
	'192.168.26.102',
	'192.168.26.103',
	'192.168.26.104',
	'192.168.26.109',
	'192.168.26.114',
	'192.168.26.119',
	'192.168.26.124',
	'192.168.26.129',
	'192.168.26.134',
	'192.168.26.139',
	'192.168.26.14',
	'192.168.26.144',
	'192.168.26.149',
	'192.168.26.152',
	'192.168.26.155',
	'192.168.26.160',
	'192.168.26.165',
	'192.168.26.170',
	'192.168.26.175',
	'192.168.26.180',
	'192.168.26.185',
	'192.168.26.19',
	'192.168.26.190',
	'192.168.26.195',
	'192.168.26.200',
	'192.168.26.202',
	'192.168.26.203',
	'192.168.26.207',
	'192.168.26.212',
	'192.168.26.217',
	'192.168.26.222',
	'192.168.26.227',
	'192.168.26.232',
	'192.168.26.237',
	'192.168.26.24',
	'192.168.26.242',
	'192.168.26.247',
	'192.168.26.25',
	'192.168.26.252',
	'192.168.26.253',
	'192.168.26.254',
	'192.168.26.255',
	'192.168.26.30',
	'192.168.26.35',
	'192.168.26.4',
	'192.168.26.40',
	'192.168.26.45',
	'192.168.26.50',
	'192.168.26.55',
	'192.168.26.60',
	'192.168.26.65',
	'192.168.26.70',
	'192.168.26.75',
	'192.168.26.80',
	'192.168.26.85',
	'192.168.26.9',
	'192.168.26.90',
	'192.168.26.95',
	'192.168.27.1',
	'192.168.27.10',
	'192.168.27.100',
	'192.168.27.101',
	'192.168.27.102',
	'192.168.27.103',
	'192.168.27.104',
	'192.168.27.105',
	'192.168.27.106',
	'192.168.27.107',
	'192.168.27.108',
	'192.168.27.109',
	'192.168.27.11',
	'192.168.27.110',
	'192.168.27.111',
	'192.168.27.112',
	'192.168.27.113',
	'192.168.27.114',
	'192.168.27.115',
	'192.168.27.116',
	'192.168.27.117',
	'192.168.27.118',
	'192.168.27.119',
	'192.168.27.12',
	'192.168.27.120',
	'192.168.27.121',
	'192.168.27.122',
	'192.168.27.123',
	'192.168.27.124',
	'192.168.27.125',
	'192.168.27.126',
	'192.168.27.127',
	'192.168.27.128',
	'192.168.27.129',
	'192.168.27.13',
	'192.168.27.130',
	'192.168.27.131',
	'192.168.27.132',
	'192.168.27.133',
	'192.168.27.134',
	'192.168.27.135',
	'192.168.27.136',
	'192.168.27.137',
	'192.168.27.138',
	'192.168.27.139',
	'192.168.27.14',
	'192.168.27.140',
	'192.168.27.141',
	'192.168.27.142',
	'192.168.27.143',
	'192.168.27.144',
	'192.168.27.145',
	'192.168.27.146',
	'192.168.27.147',
	'192.168.27.148',
	'192.168.27.149',
	'192.168.27.15',
	'192.168.27.150',
	'192.168.27.151',
	'192.168.27.152',
	'192.168.27.153',
	'192.168.27.154',
	'192.168.27.155',
	'192.168.27.156',
	'192.168.27.157',
	'192.168.27.158',
	'192.168.27.159',
	'192.168.27.16',
	'192.168.27.160',
	'192.168.27.161',
	'192.168.27.162',
	'192.168.27.163',
	'192.168.27.164',
	'192.168.27.165',
	'192.168.27.166',
	'192.168.27.167',
	'192.168.27.168',
	'192.168.27.169',
	'192.168.27.17',
	'192.168.27.170',
	'192.168.27.171',
	'192.168.27.172',
	'192.168.27.173',
	'192.168.27.174',
	'192.168.27.175',
	'192.168.27.176',
	'192.168.27.177',
	'192.168.27.178',
	'192.168.27.179',
	'192.168.27.18',
	'192.168.27.180',
	'192.168.27.181',
	'192.168.27.182',
	'192.168.27.183',
	'192.168.27.184',
	'192.168.27.185',
	'192.168.27.186',
	'192.168.27.187',
	'192.168.27.188',
	'192.168.27.189',
	'192.168.27.19',
	'192.168.27.190',
	'192.168.27.191',
	'192.168.27.192',
	'192.168.27.193',
	'192.168.27.194',
	'192.168.27.195',
	'192.168.27.196',
	'192.168.27.197',
	'192.168.27.198',
	'192.168.27.199',
	'192.168.27.2',
	'192.168.27.20',
	'192.168.27.200',
	'192.168.27.201',
	'192.168.27.202',
	'192.168.27.203',
	'192.168.27.204',
	'192.168.27.205',
	'192.168.27.206',
	'192.168.27.207',
	'192.168.27.208',
	'192.168.27.209',
	'192.168.27.21',
	'192.168.27.210',
	'192.168.27.211',
	'192.168.27.212',
	'192.168.27.213',
	'192.168.27.214',
	'192.168.27.215',
	'192.168.27.216',
	'192.168.27.217',
	'192.168.27.218',
	'192.168.27.219',
	'192.168.27.22',
	'192.168.27.220',
	'192.168.27.221',
	'192.168.27.222',
	'192.168.27.223',
	'192.168.27.224',
	'192.168.27.225',
	'192.168.27.226',
	'192.168.27.227',
	'192.168.27.228',
	'192.168.27.229',
	'192.168.27.23',
	'192.168.27.230',
	'192.168.27.231',
	'192.168.27.232',
	'192.168.27.233',
	'192.168.27.234',
	'192.168.27.235',
	'192.168.27.236',
	'192.168.27.237',
	'192.168.27.238',
	'192.168.27.239',
	'192.168.27.24',
	'192.168.27.240',
	'192.168.27.241',
	'192.168.27.242',
	'192.168.27.243',
	'192.168.27.244',
	'192.168.27.245',
	'192.168.27.246',
	'192.168.27.247',
	'192.168.27.248',
	'192.168.27.249',
	'192.168.27.25',
	'192.168.27.250',
	'192.168.27.251',
	'192.168.27.252',
	'192.168.27.253',
	'192.168.27.254',
	'192.168.27.26',
	'192.168.27.27',
	'192.168.27.28',
	'192.168.27.29',
	'192.168.27.3',
	'192.168.27.30',
	'192.168.27.31',
	'192.168.27.32',
	'192.168.27.33',
	'192.168.27.34',
	'192.168.27.35',
	'192.168.27.36',
	'192.168.27.37',
	'192.168.27.38',
	'192.168.27.39',
	'192.168.27.4',
	'192.168.27.40',
	'192.168.27.41',
	'192.168.27.42',
	'192.168.27.43',
	'192.168.27.44',
	'192.168.27.45',
	'192.168.27.46',
	'192.168.27.47',
	'192.168.27.48',
	'192.168.27.49',
	'192.168.27.5',
	'192.168.27.50',
	'192.168.27.51',
	'192.168.27.52',
	'192.168.27.53',
	'192.168.27.54',
	'192.168.27.55',
	'192.168.27.56',
	'192.168.27.57',
	'192.168.27.58',
	'192.168.27.59',
	'192.168.27.6',
	'192.168.27.60',
	'192.168.27.61',
	'192.168.27.62',
	'192.168.27.63',
	'192.168.27.64',
	'192.168.27.65',
	'192.168.27.66',
	'192.168.27.67',
	'192.168.27.68',
	'192.168.27.69',
	'192.168.27.7',
	'192.168.27.70',
	'192.168.27.71',
	'192.168.27.72',
	'192.168.27.73',
	'192.168.27.74',
	'192.168.27.75',
	'192.168.27.76',
	'192.168.27.77',
	'192.168.27.78',
	'192.168.27.79',
	'192.168.27.8',
	'192.168.27.80',
	'192.168.27.81',
	'192.168.27.82',
	'192.168.27.83',
	'192.168.27.84',
	'192.168.27.85',
	'192.168.27.86',
	'192.168.27.87',
	'192.168.27.88',
	'192.168.27.89',
	'192.168.27.9',
	'192.168.27.90',
	'192.168.27.91',
	'192.168.27.92',
	'192.168.27.93',
	'192.168.27.94',
	'192.168.27.95',
	'192.168.27.96',
	'192.168.27.97',
	'192.168.27.98',
	'192.168.27.99',
	'192.168.28.0',
	'192.168.28.1',
	'192.168.28.100',
	'192.168.28.101',
	'192.168.28.102',
	'192.168.28.103',
	'192.168.28.106',
	'192.168.28.11',
	'192.168.28.111',
	'192.168.28.116',
	'192.168.28.121',
	'192.168.28.126',
	'192.168.28.131',
	'192.168.28.136',
	'192.168.28.141',
	'192.168.28.146',
	'192.168.28.151',
	'192.168.28.152',
	'192.168.28.157',
	'192.168.28.16',
	'192.168.28.162',
	'192.168.28.167',
	'192.168.28.172',
	'192.168.28.177',
	'192.168.28.182',
	'192.168.28.187',
	'192.168.28.192',
	'192.168.28.197',
	'192.168.28.202',
	'192.168.28.203',
	'192.168.28.204',
	'192.168.28.209',
	'192.168.28.21',
	'192.168.28.214',
	'192.168.28.219',
	'192.168.28.224',
	'192.168.28.229',
	'192.168.28.234',
	'192.168.28.239',
	'192.168.28.244',
	'192.168.28.249',
	'192.168.28.25',
	'192.168.28.252',
	'192.168.28.253',
	'192.168.28.254',
	'192.168.28.27',
	'192.168.28.32',
	'192.168.28.37',
	'192.168.28.42',
	'192.168.28.47',
	'192.168.28.52',
	'192.168.28.57',
	'192.168.28.6',
	'192.168.28.62',
	'192.168.28.67',
	'192.168.28.72',
	'192.168.28.77',
	'192.168.28.82',
	'192.168.28.87',
	'192.168.28.92',
	'192.168.28.97',
	'193.25.173.21',
	'193.28.228.68',
	'193.88.6.19',
	'194.109.206.212',
	'194.14.172.60',
	'194.165.188.82',
	'195.228.75.190',
	'195.46.253.211',
	'195.71.226.87',
	'198.153.192.1',
	'198.153.194.1',
	'199.119.205.19',
	'199.16.172.22',
	'199.27.134.40',
	'199.48.147.41',
	'199.7.48.190',
	'199.7.48.72',
	'199.7.50.72',
	'199.7.51.72',
	'199.7.52.72',
	'199.7.54.72',
	'199.7.71.72',
	'204.11.109.22',
	'204.45.29.132',
	'204.9.163.143',
	'205.247.221.42',
	'205.251.72.172',
	'208.29.69.200',
	'208.29.69.210',
	'208.29.69.216',
	'209.15.238.254',
	'209.53.113.221',
	'212.186.197.146',
	'213.185.227.85',
	'213.199.179.140',
	'213.199.179.141',
	'213.199.179.143',
	'213.199.179.145',
	'213.199.179.146',
	'213.199.179.147',
	'213.199.179.148',
	'213.199.179.149',
	'213.199.179.152',
	'213.199.179.154',
	'213.199.179.158',
	'213.199.179.159',
	'213.199.179.161',
	'213.199.179.162',
	'213.239.220.43',
	'213.246.51.24',
	'217.172.172.7',
	'217.199.162.162',
	'217.76.19.6',
	'239.255.255.250',
	'255.255.255.255',
	'3.60.18.100',
	'31.172.30.3',
	'46.167.245.138',
	'46.4.120.136',
	'62.220.135.129',
	'64.134.255.10',
	'64.134.255.2',
	'64.215.255.16',
	'64.215.255.32',
	'64.215.255.40',
	'64.215.255.41',
	'64.215.255.48',
	'64.215.255.89',
	'64.4.18.90',
	'64.4.23.140',
	'64.4.23.141',
	'64.4.23.143',
	'64.4.23.145',
	'64.4.23.146',
	'64.4.23.147',
	'64.4.23.148',
	'64.4.23.149',
	'64.4.23.152',
	'64.4.23.154',
	'64.4.23.157',
	'64.4.23.162',
	'64.4.23.165',
	'65.55.223.12',
	'65.55.223.14',
	'65.55.223.16',
	'65.55.223.19',
	'65.55.223.20',
	'65.55.223.26',
	'65.55.223.28',
	'65.55.223.37',
	'67.201.31.54',
	'68.87.64.150',
	'68.87.75.198',
	'69.162.138.144',
	'69.42.126.107',
	'69.58.183.140',
	'70.37.129.106',
	'70.37.129.63',
	'70.42.33.241',
	'72.36.210.254',
	'74.120.13.132',
	'74.125.235.207',
	'74.3.165.39',
	'77.109.139.87',
	'77.207.111.206',
	'77.244.246.178',
	'77.87.36.179',
	'78.46.119.2',
	'8.26.56.26',
	'8.8.8.8',
	'81.170.186.175',
	'81.170.234.182',
	'82.128.207.152',
	'83.133.106.73',
	'83.140.59.2',
	'83.248.139.93',
	'84.209.60.252',
	'85.10.198.236',
	'85.17.20.241',
	'85.24.188.63',
	'85.25.120.14',
	'87.231.117.240',
	'87.73.90.232',
	'87.98.178.61',
	'88.198.100.232',
	'91.121.166.158',
	'91.229.20.182',
	'92.243.8.139',
	'93.186.179.119',
	'93.80.10.221',
	'94.23.34.155',
	'94.75.228.29',
	'95.79.25.114',
	'96.6.171.141',
	'97.74.177.128']

firewall_ip = [
	'239.255.255.250',
	'255.255.255.255',
	'109.201.131.11',
	'110.209.6.25',
	'111.221.74.12',
	'111.221.74.13',
	'111.221.74.14',
	'111.221.74.16',
	'111.221.74.17',
	'111.221.74.18',
	'111.221.74.19',
	'111.221.74.23',
	'111.221.74.25',
	'111.221.74.26',
	'111.221.74.28',
	'111.221.74.31',
	'111.221.74.34',
	'111.221.74.37',
	'111.221.74.38',
	'111.221.77.140',
	'111.221.77.141',
	'111.221.77.143',
	'111.221.77.145',
	'111.221.77.146',
	'111.221.77.147',
	'111.221.77.148',
	'111.221.77.149',
	'111.221.77.153',
	'111.221.77.155',
	'111.221.77.159',
	'111.221.77.160',
	'111.221.77.162',
	'111.221.77.165',
	'137.56.163.64',
	'141.219.155.230',
	'149.5.45.140',
	'149.5.45.166',
	'149.9.0.58',
	'154.35.32.5',
	'156.154.70.22',
	'157.55.130.146',
	'157.55.130.151',
	'157.55.130.152',
	'157.55.130.153',
	'157.55.130.156',
	'157.55.130.157',
	'157.55.130.158',
	'157.55.130.159',
	'157.55.130.160',
	'157.55.130.161',
	'157.55.130.162',
	'157.55.130.165',
	'157.55.235.140',
	'157.55.235.142',
	'157.55.235.144',
	'157.55.235.145',
	'157.55.235.146',
	'157.55.235.147',
	'157.55.235.151',
	'157.55.235.152',
	'157.55.235.153',
	'157.55.235.154',
	'157.55.235.156',
	'157.55.235.158',
	'157.55.235.160',
	'157.55.235.162',
	'157.55.235.165',
	'157.55.56.140',
	'157.55.56.141',
	'157.55.56.143',
	'157.55.56.144',
	'157.55.56.145',
	'157.55.56.147',
	'157.55.56.148',
	'157.55.56.150',
	'157.55.56.152',
	'157.55.56.155',
	'157.55.56.157',
	'157.55.56.159',
	'157.55.56.160',
	'157.55.56.162',
	'157.55.56.165',
	'157.56.52.12',
	'157.56.52.14',
	'157.56.52.15',
	'157.56.52.16',
	'157.56.52.17',
	'157.56.52.18',
	'157.56.52.19',
	'157.56.52.24',
	'157.56.52.25',
	'157.56.52.28',
	'157.56.52.30',
	'157.56.52.33',
	'157.56.52.37',
	'157.56.52.38',
	'159.99.66.200',
	'17.151.16.22',
	'17.151.16.30',
	'17.171.4.24',
	'171.25.193.21',
	'173.194.43.0',
	'173.194.43.1',
	'173.194.43.10',
	'173.194.43.14',
	'173.194.43.17',
	'173.194.43.2',
	'173.194.43.20',
	'173.194.43.26',
	'173.194.43.3',
	'173.194.43.4',
	'173.194.43.5',
	'173.194.43.6',
	'173.194.43.7',
	'173.194.43.8',
	'173.194.43.9',
	'173.245.60.114',
	'174.129.217.197',
	'174.129.243.85',
	'176.31.122.29',
	'176.9.106.116',
	'178.238.224.71',
	'178.255.83.1',
	'178.255.83.2',
	'178.63.16.48',
	'178.63.97.34',
	'183.182.82.14',
	'184.49.188.129',
	'187.11.237.198',
	'188.40.209.99',
	'188.40.59.123',
	'188.40.98.54',
	'193.25.173.21',
	'193.28.228.68',
	'193.88.6.19',
	'194.109.206.212',
	'194.14.172.60',
	'194.165.188.82',
	'195.228.75.190',
	'195.46.253.211',
	'195.71.226.87',
	'198.153.192.1',
	'198.153.194.1',
	'199.119.205.19',
	'199.16.172.22',
	'199.27.134.40',
	'199.48.147.41',
	'199.7.48.190',
	'199.7.48.72',
	'199.7.50.72',
	'199.7.51.72',
	'199.7.52.72',
	'199.7.54.72',
	'199.7.71.72',
	'204.11.109.22',
	'204.45.29.132',
	'204.9.163.143',
	'205.247.221.42',
	'205.251.72.172',
	'208.29.69.200',
	'208.29.69.210',
	'208.29.69.216',
	'209.15.238.254',
	'209.53.113.221',
	'212.186.197.146',
	'213.185.227.85',
	'213.199.179.140',
	'213.199.179.141',
	'213.199.179.143',
	'213.199.179.145',
	'213.199.179.146',
	'213.199.179.147',
	'213.199.179.148',
	'213.199.179.149',
	'213.199.179.152',
	'213.199.179.154',
	'213.199.179.158',
	'213.199.179.159',
	'213.199.179.161',
	'213.199.179.162',
	'213.239.220.43',
	'213.246.51.24',
	'217.172.172.7',
	'217.199.162.162',
	'217.76.19.6',
	'3.60.18.100',
	'31.172.30.3',
	'46.167.245.138',
	'46.4.120.136',
	'62.220.135.129',
	'64.134.255.10',
	'64.134.255.2',
	'64.215.255.16',
	'64.215.255.32',
	'64.215.255.40',
	'64.215.255.41',
	'64.215.255.48',
	'64.215.255.89',
	'64.4.18.90',
	'64.4.23.140',
	'64.4.23.141',
	'64.4.23.143',
	'64.4.23.145',
	'64.4.23.146',
	'64.4.23.147',
	'64.4.23.148',
	'64.4.23.149',
	'64.4.23.152',
	'64.4.23.154',
	'64.4.23.157',
	'64.4.23.162',
	'64.4.23.165',
	'65.55.223.12',
	'65.55.223.14',
	'65.55.223.16',
	'65.55.223.19',
	'65.55.223.20',
	'65.55.223.26',
	'65.55.223.28',
	'65.55.223.37',
	'67.201.31.54',
	'68.87.64.150',
	'68.87.75.198',
	'69.162.138.144',
	'69.42.126.107',
	'69.58.183.140',
	'70.37.129.106',
	'70.37.129.63',
	'70.42.33.241',
	'72.36.210.254',
	'74.120.13.132',
	'74.125.235.207',
	'74.3.165.39',
	'77.109.139.87',
	'77.207.111.206',
	'77.244.246.178',
	'77.87.36.179',
	'78.46.119.2',
	'8.26.56.26',
	'8.8.8.8',
	'81.170.186.175',
	'81.170.234.182',
	'82.128.207.152',
	'83.133.106.73',
	'83.140.59.2',
	'83.248.139.93',
	'84.209.60.252',
	'85.10.198.236',
	'85.17.20.241',
	'85.24.188.63',
	'85.25.120.14',
	'87.231.117.240',
	'87.73.90.232',
	'87.98.178.61',
	'88.198.100.232',
	'91.121.166.158',
	'91.229.20.182',
	'92.243.8.139',
	'93.186.179.119',
	'93.80.10.221',
	'94.23.34.155',
	'94.75.228.29',
	'95.79.25.114',
	'96.6.171.141',
	'97.74.177.128']
#----------------------------------------# SETTING UP HIERARCHIES

#----------------------------------------# HEIRARCHIES
hierarchy_port = {
	'ANY_PORT':['PRIV','NON_PRIV'],
	'PRIV':priv_port_list,
	'NON_PRIV':non_priv_port_list
	}

hierarchy_ip = {
	'ANY_IP':['DMZ','INTERNET'],
	'DMZ':['FIREWALL','ip3','HTTP/FTP'],
	'FIREWALL':firewall_ip,
	'HTTP/FTP':http_ftp_ip,
	'INTERNET':internet_ip
	}
#----------------------------------------# HEIRARCHIES

#----------------------------------------# Start source [2] *** WORKING ***
def find_shortest_path(graph, start, end, path=[]):
	path = path + [start]
	if start == end:
		return path
	if not graph.has_key(start):
		return None
	shortest = None
	for node in graph[start]:
		if node not in path:
			newpath = find_shortest_path(graph, node, end, path)
			if newpath:
				if not shortest or len(newpath) < len(shortest):
					shortest = newpath
	return shortest
#----------------------------------------# End source [2] *** WORKING ***

#----------------------------------------# DISSIMILARITY FUNCTION VIA FIND SHORTEST PATH *** WORKING ***
def find_dissimilarity(graph, start, end_1, end_2):
	distance_1 = find_shortest_path(graph, start, end_1)
	distance_2 = find_shortest_path(graph, start, end_2)
	non_matches = 0

	length_1 = len(distance_1)
	length_2 = len(distance_2)

	if(length_1 > length_2):
		length = length_1 - length_2
		for i in distance_1:
			if i not in distance_2:
				non_matches = non_matches + 1
		total_distance = (non_matches * 2) - length
	elif(length_2 > length_1):
		length = length_2 - length_1
		for i in distance_2:
			if i not in distance_1:
				non_matches = non_matches + 1
		total_distance = (non_matches * 2) - length
	elif(length_1 == 1 and length_2 == 1):
		total_distance = 1
	else:
		for i in distance_1:
			if i not in distance_2:
				non_matches = non_matches + 1
		total_distance = non_matches * 2

	return total_distance
#----------------------------------------# DISSIMILARITY FUNCTION VIA FIND SHORTEST PATH *** WORKING ***
"""
#----------------------------------------# SETTING MINIMUM SIZE PARAMETER *** IS THIS NEEDED ***
def setting_minsize(ms):
	eps = 0.05
	robust_1 = ms
	robust_2 = (1 - eps) * ms
	robust_3 = (1 + eps) * ms

	#RUN CLUSTERING ALGORITHM
	#MS IS EPS-ROBUST IF ALL SIMULATIONS HAVE THE SAME RESULT
	#ITERATIVELY RUN THIS FUNCTION UNTIL ALL 3 VALUES ARE THE SAME

	return ms
#----------------------------------------# SETTING MINIMUM SIZE PARAMETER *** IS THIS NEEDED ***
"""
#----------------------------------------# FINDS THE DIFFERENCES BETWEEN TWO LISTS AND THEIR INDEXES *** WORKING ***
def attribute_checker(list1, list2): # USING LISTS
	different_attributes = [i for i in list1 + list2 if i not in list1 or i not in list2] 
	list2_att = []
	list2_att_ind = []

	for i in different_attributes:
		if i in list2:
			list2_att.append(i)
			list2_att_ind.append(list2.index(i)) 
	return list2_att, sorted(list2_att_ind), len(list2_att_ind)

def attribute_checker_2(list1, list2): # USING SETS
	different_attributes = list(set(list2) - set(list1))
	att_ind = []
	att_diff_2 = []

	for i in different_attributes:
		att_ind.append(list2.index(i))
	
	
	return different_attributes, att_ind, len(att_ind)
#----------------------------------------# FINDS THE DIFFERENCES BETWEEN TWO LISTS AND THEIR INDEXES *** WORKING ***

#----------------------------------------# REMOVING ALARM AFTER IT HAS BEEN GENERALIZED *** WORKING ***
def alarm_removal(alarms, removed):
	alarms.remove(removed)
	return alarms
#----------------------------------------# REMOVING ALARM AFTER IT HAS BEEN GENERALIZED *** WORKING ***

#----------------------------------------# CHANGES ATTRIBUTE TO ITS CORRESPONDING PARENT IN THE DAG *** WORKING ***
def dag_parent(attribute, next):
	if(attribute == 2 or attribute == 4):
		return hierarchy_port.keys()[hierarchy_port.values().index(priv_port_list)] # PRIVILEDGED
		return hierarchy_port.keys()[hierarchy_port.values().index(non_priv_port_list)] # NON-PRIVILEDGED
	elif(attribute == 3 or attribute == 5)
		return hierarchy_ip.keys()[hierarchy_ip.values().index(http_ftp_ip)] # HTTP/FTP
		return hierarchy_ip.keys()[hierarchy_ip.values().index(internet_ip)] # INTERNET
		return hierarchy_ip.keys()[hierarchy_ip.values().index(firewall_ip)] # FIREWALL
	else:
		return "Selected Attribute Invalid"
#----------------------------------------# CHANGES ATTRIBUTE TO ITS CORRESPONDING PARENT IN THE DAG *** WORKING ***

#----------------------------------------# ATTRIBUTE SELECTION HEURISTIC
def attribute_selection(list1, list2): 
	count = [0, 0, 0, 0, 0, 0] # INDEX REPRESENTS EACH ATTRIBUTE

	for i in attribute_checker(list1, list2):
		count[i] = count[i] + 1 
	
	return count
#----------------------------------------# ATTRIBUTE SELECTION HEURISTIC

#----------------------------------------# GENERALIZING: CASE 1 - WHEN TWO ALARMS ARE IDENTICAL
def alarm_clustering_identical_alarms(alarms):
	alarm_clusters = []
	alarm_cluster_full = []
	for i in alarms:
		count_1 = 0
		for j in alarms[alarms.index(i) + 1:]:
			if(i == j): 
				count_1 = count_1 + 1
				alarms = alarm_removal(alarms, j)
		alarm_clusters.append([count_1  + 1, i])
		alarms = alarm_removal(alarms, i)
	return alarm_clusters
#----------------------------------------# GENERALIZING: CASE 1 - WHEN TWO ALARMS ARE IDENTICAL

#----------------------------------------# GENERALIZE TO PARENT IN DAG
def cluster_case_2(alarms):
	for i in alarms:
		count_1 = 0
		for j in alarms[alarms.index(i) + 1:]:
			diff = list(attribute_checker(i, j))
			if(diff[2] == 0):
				print("I am the same!")
				alarms = alarm_removal(alarms, j)
			elif(diff[2] <= 2):
				print(diff[1])
				if(diff[1][0] == 2):
					j[2] = dag_parent(2)
				#elif(diff[1][0] == 3):
				#elif(diff[1][0] == 4):
				#elif(diff[1][0] == 5):

				alarms = alarm_removal(alarms, j)
			else:
				print("Well then...")
				alarms = alarm_removal(alarms, j)
	return "Done"
#----------------------------------------# GENERALIZE TO PARENT IN DAG

#elif(diff[2] <= 2): #CASE 2 - TWO DIFFERENCES WITH ATTRIBUTES, GENERALIZE TWO DIFFERENCES 

a2 = [
	['ET SCAN Nmap Scripting Engine User-Agent Detected (Nmap Scripting Engine)', 'Web Application Attack', '80', '192.168.202.79', '80', '192.168.229.251'],
	['ET SCAN Nmap Scripting Engine User-Agent Detected (Nmap Scripting Engine)', 'Web Application Attack', '80', '192.168.202.79', '80', '192.168.229.251'],
	['ET SCAN Nmap Scripting Engine User-Agent Detected (Nmap Scripting Engine)', 'Web Application Attack', '80', '192.168.202.79', '80', '192.168.229.251'],
	['ET SCAN Nmap Scripting Engine User-Agent Detected (Nmap Scripting Engine)', 'Web Application Attack', '80', '192.168.202.79', '80', '192.168.229.251'],
	['ET SCAN Nmap Scripting Engine User-Agent Detected (Nmap Scripting Engine)', 'Web Application Attack', '80', '192.168.202.79', '80', '192.168.229.251'],
	['ET SCAN Nmap Scripting Engine User-Agent Detected (Nmap Scripting Engine)', 'Web Application Attack', '80', '192.168.202.79', '80', '192.168.229.251'],
	['ET SCAN Nmap Scripting Engine User-Agent Detected (Nmap Scripting Engine)', 'Web Application Attack', '90', '192.168.202.79', '60', '192.168.229.251'],
	['ET SCAN Nmap Scripting Engine User-Agent Detected (Nmap Scripting Engine)', 'Web Application Attack', '90', '192.168.202.79', '60', '192.168.229.251']]

a3 = [
	['ET SCAN Nmap Scripting Engine User-Agent Detected (Nmap Scripting Engine)', 'Web Application Attack', '50497', '192.168.202.79', '80', '192.168.229.251'],
	['ET SCAN Nmap Scripting Engine User-Agent Detected (Nmap Scripting Engine)', 'Web Application Attack', '50499', '192.168.202.79', '80', '192.168.229.251'],
	['ET SCAN Nmap Scripting Engine User-Agent Detected (Nmap Scripting Engine)', 'Web Application Attack', '50501', '192.168.202.79', '80', '192.168.229.251'],
	['ET SCAN Nmap Scripting Engine User-Agent Detected (Nmap Scripting Engine)', 'Web Application Attack', '50503', '192.168.202.79', '80', '192.168.229.251'],
	['ET SCAN Nmap Scripting Engine User-Agent Detected (Nmap Scripting Engine)', 'Web Application Attack', '50504', '192.168.202.79', '80', '192.168.229.251'],
	['ET SCAN Nmap Scripting Engine User-Agent Detected (Nmap Scripting Engine)', 'Web Application Attack', '50506', '192.168.202.79', '80', '192.168.229.251'],
	['ET SCAN Nmap Scripting Engine User-Agent Detected (Nmap Scripting Engine)', 'Web Application Attack', '50508', '192.168.202.79', '80', '192.168.229.251']]

x1 = ['ET SCAN Nmap Scripting Engine User-Agent Detected (Nmap Scripting Engine)', 'Web Application Attack', '90', '192.168.202.79', '80', '192.168.229.251']
x2 = ['ET SCAN Nmap Scripting Engine User-Agent Detected (Nmap Scripting Engine)', 'Web Application Attack', '3232', '192.168.202.7', '80', '192.168.229.251']

x3 = [1,2,3,4,5]
x4 = [1,2,3,4,6]

#print(attribute_checker(x1, x2))

print(cluster_case_2(a2))


"""
for i in alarm_clustering_identical_alarms(a2):
	print i

[0 Alarm Type, 1 Alarm Classification, 2 Source Port, 3 Source IP, 4 Dest Port, 5 Dest IP]
"""